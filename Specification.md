# CIS4301 Library Database Project

### Overview
For this assignment you are tasked with creating the backend for a Library DBMS. The frontend a CLI written in python 
that is provided for you, so you only need to work on the functions in the db_handler.py file. We have provided the function definitions along with docstrings that discuss the parameters and return values. It is recommended that you
work on the functions as the class progresses to keep a steady pace, and not leave everything for the night before it is due.

### Data Models
When getting data from a DB table, it is naturally returned as a 2d list. The indices of the columns within that list
depend on the order of attributes from the `SELECT` clause. To standardize passing data between the frontend and backend, 
we have provided Python objects that correspond to a row in each table, i.e. the Book object represents a book in the 
Book table. These objects are available to you and can be found in the `models` directory. Whenever the db\_handler passes eligible data to the frontend, it is required to be stored in the corresponding object.
Otherwise, the program will likely crash. It is recommended but not required to create helper functions in the db_handler 
that can handle the conversion of a 2d list from a table, into a list of objects. 

### Functions

| Function                       | Description                                                                                                                                                                                                                                                        | Corresponding Module |
|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
| **Create, Update, and Delete** |                                                                                                                                                                                                                                                                    |                      |
| `add_book`                     | Insert a new book into the Book table                                                                                                                                                                                                                              | SQL I                |
| `add_user`                     | Insert a new user into the User table                                                                                                                                                                                                                              | SQL I                |
| `checkout_book`                | Given a Loan object, insert it into the Loan Table                                                                                                                                                                                                                 | SQL I                |
| `waitlist_user`                | Given an ISBN and account\_id, waitlist the user for the corresponding book. You must place the user at the end of the waitlist                                                                                                                                    | SQL II               |
| `return_book`                  | Given an ISBN, account\_id, and return\_date — find the corresponding checkout date and due date, and insert a new record into the LoanHistory table. Additionally, the corresponding row in the Loan table should be deleted since the book has now been returned | SQL II               |
| `edit_user`                    | Update an existing user's information                                                                                                                                                                                                                              | SQL III              |
| `grant_extension`              | Given an ISBN, account\_id, and new\_due\_date — Update the corresponding record in the Loan table to store the new due date instead of the previous one                                                                                                           | SQL III              |
| `update_waitlist`              | Given an ISBN, find every user on it's waitlist and move them up a spot while removing the person at the front of the line                                                                                                                                         | SQL III              |
| **Filter and Search**          |                                                                                                                                                                                                                                                                    |                      |
| `get_filtered_users`           | Given various filter parameters, return a list of User objects containing every user that meets the criteria.                                                                                                                                                      | SQL I                | 
| `get_filtered_books`           | The same as above but with Books                                                                                                                                                                                                                                   | SQL II               | 
| `get_filtered_loans`           | The same as above but with Loans                                                                                                                                                                                                                                   | SQL II               | 
| `get_filtered_loan_histories`  | The same as above but with LoanHistory entries                                                                                                                                                                                                                     | SQL II               | 
| `get_filtered_waitlist`        | The same as above but with Waitlist entries                                                                                                                                                                                                                        | SQL II               | 
| **Helper Functions**           |                                                                                                                                                                                                                                                                    |                      |
| `save_changes`                 | Saves the changes made to the DB                                                                                                                                                                                                                                   | SQL I                |
| `place_in_line`                | Given an ISBN and account\_id, find the user's place in the waitlist for the book. If the user is not in the waitlist then return -1                                                                                                                               | SQL I                |
| `number_in_stock`              | Given an ISBN, return the number of copies that the library currently has in stock. If the branch does not own the book then -1 should be returned                                                                                                                 | SQL II               |
| `line_length`                  | Given an ISBN, return the total number of people on the waitlist for that book. If no one is on the waitlist, then return 0                                                                                                                                        | SQL II               |
